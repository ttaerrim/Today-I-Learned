# Promise

## âœ”ï¸ Promiseë€?

ì¤‘ì²©ë˜ëŠ” ë¹„ë™ê¸° í†µì‹  ë¡œì§ê³¼ ì½œë°± ì§€ì˜¥ì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ê¸°ë²•ì´ë‹¤.

> ì¸í„°ë„· ìµìŠ¤í”Œë¡œëŸ¬ëŠ” í”„ë¡œë¯¸ìŠ¤ë¥¼ ì§€ì›í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì¸í„°ë„· ìµìŠ¤í”Œë¡œëŸ¬ í˜¸í™˜ì„±ì´ í•„ìš”í•˜ë‹¤ë©´ í”„ë¡œë¯¸ìŠ¤ ëŒ€ì‹  AJAXë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

## âœ”ï¸ í”„ë¡œë¯¸ìŠ¤ ê°ì²´ì˜ ìƒíƒœ

í”„ë¡œë¯¸ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ëŠ” ì§„í–‰ ì¤‘ì¸ ë¹„ë™ê¸° ì‘ì—…, ê·¸ì— ë”°ë¥¸ ê²°ê³¼ ì²˜ë¦¬ ë°©ë²•, ìƒíƒœ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆë‹¤.

í”„ë¡œë¯¸ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ëŠ” `Pending`, `Fulfilled`, `Rejected` 3ê°œì˜ ìƒíƒœ ì •ë³´ë¥¼ ê°€ì§„ë‹¤. ê·¸ë¦¬ê³  ìƒíƒœì— ë”°ë¥¸ 2ê°œì˜ ë©”ì†Œë“œ `resolve`ì™€ `reject`ë¥¼ ê°€ì§„ë‹¤.

| ìƒíƒœ                 | ì„¤ëª…                                                             |
| :------------------- | :--------------------------------------------------------------- |
| ëŒ€ê¸° ì¤‘(Pending)     | í”„ë¡œë¯¸ìŠ¤ ê°ì²´ì˜ ê¸°ë³¸ ìƒíƒœ, ë¹„ë™ê¸° ì²˜ë¦¬ ê²°ê³¼ê°€ ë‚˜ì˜¤ì§€ ì•Šì€ ìƒíƒœ   |
| ì´í–‰ ì™„ë£Œ(Fulfilled) | ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì–´ ê²°ê³¼ë¥¼ ì–»ì€ ìƒíƒœ. resolve() í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•¨ |
| ê±°ë¶€ë¨(Rejected)     | ë¹„ë™ê¸° ì²˜ë¦¬ëŠ” ì™„ë£Œë˜ì—ˆì§€ë§Œ ì‹¤íŒ¨í•œ ìƒíƒœ. reject() í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•¨   |

## âœ”ï¸ í”„ë¡œë¯¸ìŠ¤ ê¸°ë³¸ ì‚¬ìš©ë²•

```javascript
let myPromise = new Promise((resolve, reject) => {
  setTimeout(() => {
    let result = "promise fulfilled";
    resolve(result);
  }, 1000);
});

myPromise
  .then((successMessage) => {
    console.log(successMessage);
  })
  .catch((failMessage) => {
    console.log(failMessage);
  });
```

ìƒˆë¡œìš´ í”„ë¡œë¯¸ìŠ¤ ê°ì²´ë¥¼ ì‘ì„±í•  ë•ŒëŠ” íŒŒë¼ë©”í„° 2ê°œë¥¼ ê°€ì§€ëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ í•¨ìˆ˜ë¥¼ ì‘ì„±í•œë‹¤. ì²« ë²ˆì§¸ íŒŒë¼ë¯¸í„°ëŠ” ì„±ê³µí–ˆì„ ë•Œ í˜¸ì¶œí•˜ëŠ” **ì´í–‰ ì™„ë£Œ í•¨ìˆ˜ëª…**ì´ê³ , ë‘ ë²ˆì§¸ íŒŒë¼ë¯¸í„°ëŠ” ì‹¤íŒ¨í–ˆì„ ë•Œ í˜¸ì¶œí•˜ëŠ” **ê±°ë¶€ í•¨ìˆ˜ëª…**ì´ë‹¤.

ê´€ìŠµì ìœ¼ë¡œ ì´í–‰ ì™„ë£Œ í•¨ìˆ˜ëª…ì€ resolve, ê±°ë¶€ í•¨ìˆ˜ëª…ì€ rejectë¡œ ì‘ì„±í•˜ì§€ë§Œ success, fail ë“±ìœ¼ë¡œ ì‘ì„±í•´ë„ ê´œì°®ë‹¤.

íŒŒë¼ë©”í„°ì—ì„œ ì •í•œ í•¨ìˆ˜ëª…ì„ í˜¸ì¶œí•˜ë©´ then()ê³¼ catch() ì¤‘ í•˜ë‚˜ë¥¼ í˜¸ì¶œí•œë‹¤. resolve()ê°€ í˜¸ì¶œë˜ë©´ then() ë©”ì„œë“œì˜ íŒŒë¼ë©”í„°ì— ì •ì˜í•œ ì½œë°± í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê³ , reject()ê°€ í˜¸ì¶œë˜ë©´ catch() ë©”ì„œë“œì˜ íŒŒë¼ë©”í„°ì— ì •ì˜í•œ ì½œë°± í•¨ìˆ˜ê°€ ì‹¤í–‰ëœë‹¤.

## âœ”ï¸ ë‹¤ì¤‘ í”„ë¡œë¯¸ìŠ¤ ì²˜ë¦¬

```javascript
function asyncWork(value) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      value -= 20;
      if (value > 50) {
        resolve(value);
      } else {
        reject(value);
      }
    });
  });
}

asyncWork(100)
  .then((value) => {
    console.log(value);
    return asyncWork(value);
  })
  .then((value) => {
    console.log(value);
    return asyncWork(value);
  })
  .then((value) => {
    console.log(value);
    return asyncWork(value);
  })
  .catch((error) => {
    console.log("catch: " + error);
  });
```

```console
80
60
catch: 40
```

asyncWork í•¨ìˆ˜ëŠ” í”„ë¡œë¯¸ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•œë‹¤. ë”°ë¼ì„œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©° ë©”ì„œë“œ ì²´ì¸ìœ¼ë¡œ then()ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. ì˜ˆì œì—ì„œë„ then()ì„ ì—°ë‹¬ì•„ ì²´ì¸ ë°©ì‹ìœ¼ë¡œ ì—¬ëŸ¬ ê°œ í˜¸ì¶œí•œë‹¤.

ë‹¤ì¤‘ í”„ë¡œë¯¸ìŠ¤ëŠ” ì²´ì¸ìœ¼ë¡œ í˜¸ì¶œí•˜ëŠ” then() ë©”ì„œë“œì˜ ì½œë°± í•¨ìˆ˜ì˜ ë¦¬í„´ ê°’ìœ¼ë¡œ í”„ë¡œë¯¸ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë‹¤ì‹œ í˜¸ì¶œí•œë‹¤ëŠ” ê²ƒì´ë‹¤.

ë°˜í™˜ëœ í”„ë¡œë¯¸ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ëŠ” ë‹¤ìŒ ë²ˆ then()ì˜ í”„ë¡œë¯¸ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ê°€ ëœë‹¤.

then() ë©”ì„œë“œëŠ” ì½œë°± í•¨ìˆ˜ì—ì„œ ë°˜í™˜í•˜ëŠ” asyncWork() í”„ë¡œë¯¸ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ì˜ ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ì™„ë£Œë˜ê¸° ì „ê¹Œì§€ ë‹¤ìŒ then()ì„ í˜¸ì¶œí•˜ì§€ ì•Šê³  ëŒ€ê¸°í•œë‹¤.

ë”°ë¼ì„œ ëª¨ë“  ë¹„ë™ê¸° ì²˜ë¦¬ ì‘ì—…ì€ thenì˜ ì½œë°± í•¨ìˆ˜ ìˆœì„œëŒ€ë¡œ í•˜ë‚˜ì”© ì‹¤í–‰ë˜ê³ , ì½œë°± í•¨ìˆ˜ì˜ íŒŒë¼ë©”í„°ë¥¼ í†µí•´ ê²°ê³¼ ê°’ì„ ìˆœì°¨ì ìœ¼ë¡œ ì „ë‹¬í•œë‹¤.

ìˆœì„œëŒ€ë¡œ then() ë©”ì„œë“œë¥¼ ë¶™ì—¬ ë‚˜ì—´í•˜ê¸° ë•Œë¬¸ì— ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•´ ì½”ë“œë¥¼ ì¤‘ì²©í•  í•„ìš”ê°€ ì—†ë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ í”„ë¡œë¯¸ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ìƒíƒœê°€ ê±°ì ˆ ìƒíƒœê°€ ë˜ë©´ ë‹¤ìŒ then()ì´ ì•„ë‹Œ catch()ë¥¼ ì‹¤í–‰í•˜ë©° ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•˜ê³  ì¢…ë£Œí•œë‹¤.

ì˜ˆì œëŠ” valueë¥¼ 20ì”© ì°¨ê°í•˜ë©° ë‹¤ìŒ then()ì„ í˜¸ì¶œí•˜ê³ , ê°’ì´ 50ë³´ë‹¤ ì‘ìœ¼ë©´ ê±°ì ˆ ìƒíƒœë¡œ ë³€ê²½í•œ í›„ catch()ë¥¼ í˜¸ì¶œí•˜ë©´ì„œ ë¹„ë™ê¸° ì²˜ë¦¬ ì²´ì¸ì„ ì¢…ë£Œí•œë‹¤.

í”„ë¡œë¯¸ìŠ¤ë¥¼ í†µí•œ ë¹„ë™ê¸° ì²˜ë¦¬ ì‘ì—…ì€ ì¤‘ë³µ ì‘ì„±í•  í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì— ì²˜ë¦¬ êµ¬ì¡°ì˜ íš¨ìœ¨ì´ ì¢‹ì•„ì§€ê³  ì½”ë“œ ëŸ‰ë„ ì¤„ì¼ ìˆ˜ ìˆë‹¤. ë˜í•œ ë¹„ë™ê¸° ì²˜ë¦¬ íë¦„ì´ í•œëˆˆì— ë“¤ì–´ì˜¤ê³  ì‹¤í–‰ êµ¬ì¡°ì™€ ìˆœì„œë¥¼ ëª…í™•í•˜ê²Œ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.

## âœ”ï¸ `Promise.all()`

`Promise.all()` ë©”ì†Œë“œëŠ” Arrayì™€ ê°™ì´ ìˆœíšŒ ê°€ëŠ¥í•œ ê°ì²´ì˜ ëª¨ë“  í”„ë¡œë¯¸ìŠ¤ê°€ ì´í–‰ ì™„ë£Œí•œ í›„ ì´í–‰í•œ í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°˜í™˜í•œë‹¤. ë§Œì¼ í”„ë¡œë¯¸ìŠ¤ ì¤‘ í•˜ë‚˜ê°€ ê±°ë¶€ëœë‹¤ë©´, ì²« ë²ˆì§¸ë¡œ ê±°ë¶€ëœ í”„ë¡œë¯¸ìŠ¤ë¥¼ ì¦‰ì‹œ ë°˜í™˜í•œë‹¤.

Promise.all()ì€ ì—¬ëŸ¬ ê°œì˜ ë¹„ë™ê¸° ì‘ì—…ì„ ë³‘ë ¬ë¡œ ì²˜ë¦¬í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•œë‹¤. ìˆœì°¨ì ìœ¼ë¡œ ì§„í–‰í•´ì•¼ í•˜ëŠ” ë¹„ë™ê¸° ì‘ì—…ì´ ì•„ë‹ˆë¼ë©´ Promise.all()ì„ ì‚¬ìš©í•˜ì—¬ í•œêº¼ë²ˆì— ì²˜ë¦¬í•˜ê³ , ì‹œê°„ì„ ë‹¨ì¶•í•  ìˆ˜ ìˆë‹¤.

```javascript
async function display(text, time) {
  return new Promise((resolve, reject) => {
    setTimeout(
      () =>
        typeof text === "string"
          ? resolve("stringì…ë‹ˆë‹¤")
          : reject("stringì´ ì•„ë‹™ë‹ˆë‹¤"),
      time
    );
  });
}

/* awaitë¥¼ ì‚¬ìš©í–ˆì„ ë•Œ */

console.time("ì†Œìš” ì‹œê°„");
await display("íƒœë¦¼", 3000);
await display("ttaerrim", 2000);
await display("LTR", 1000);
console.timeEnd("ì†Œìš” ì‹œê°„");

// ì†Œìš” ì‹œê°„: 6011.14306640625 ms

/* Promise.all ì‚¬ìš©í–ˆì„ ë•Œ */
console.time("ì†Œìš” ì‹œê°„");
await Promise.all([
  display("íƒœë¦¼", 3000),
  display("ttaerrim", 2000),
  display("LTR", 1000),
]);
console.timeEnd("ì†Œìš” ì‹œê°„");

// ì†Œìš” ì‹œê°„: 3001.381103515625 ms
```

ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²½ìš°ì—ë„ Promise.all()ì˜ ê²½ìš°ê°€ ê±¸ë¦¬ëŠ” ì‹œê°„ì´ ë” ì§§ë‹¤.

```javascript
/* awaitë¥¼ ì‚¬ìš©í–ˆì„ ë•Œ */

console.time("ì†Œìš” ì‹œê°„");
try {
  await display(1, 3000);
  await display(2, 2000);
  await display(3, 1000);
} catch (error) {
  console.log(error);
}
console.timeEnd("ì†Œìš” ì‹œê°„");

// ì†Œìš” ì‹œê°„: 3002.85791015625 ms

/* Promise.all ì‚¬ìš©í–ˆì„ ë•Œ */
console.time("ì†Œìš” ì‹œê°„");
try {
  await Promise.all([display(1, 3000), display(2, 2000), display(3, 1000)]);
} catch (error) {
  console.log(error);
}
console.timeEnd("ì†Œìš” ì‹œê°„");

// ì†Œìš” ì‹œê°„: 1002.778076171875 ms
```

ê°™ì€ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ í•˜ëŠ” ê²½ìš°ì´ì§€ë§Œ, awaitë¡œ ê°ê° ì‹¤í–‰ì‹œì¼°ì„ ê²½ìš° ì²« ë²ˆì§¸ í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ëŠ” ë° ê±¸ë¦¬ëŠ” ì‹œê°„ì¸ 3ì´ˆë¥¼ ëª¨ë‘ ë‹¤ ì±„ìš°ê³  ë°˜í™˜ëœë‹¤. Promise.all()ì„ ì‚¬ìš©í–ˆì„ ê²½ìš°ì—ëŠ” ê°€ì¥ ë¹¨ë¦¬ ì—ëŸ¬ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë™ì‘í•´ ê°€ì¥ ì§§ì€ ì‹œê°„ì¸ 1ì´ˆë§Œì— ì—ëŸ¬ë¥¼ ë°˜í™˜í•œë‹¤.

### ğŸš© ì°¸ê³ 

[ES6ë¡œ ê¸°ì´ˆë¶€í„° ë‹¤ì‹œ ë°°ìš°ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ íŒŒì›Œë¶](http://www.yes24.com/Product/Goods/93235652)  
[Promise.all()](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Promise/all)  
[ì–¸ì œ Promise.allì„ ì‚¬ìš©í•´ì•¼ ë ê¹Œ?](https://code-masterjung.tistory.com/91)
