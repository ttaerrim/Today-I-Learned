# 실행 컨텍스트

## 1. 소스코드의 타입

| 소스코드의 타입          | 설명                                                                                          |
| :----------------------- | :-------------------------------------------------------------------------------------------- |
| 전역 코드(global code)   | 전역에 존재하는 소스코드. 전역에 정의된 함수, 클래스 등 내부 코드는 포함하지 않음.            |
| 함수 코드(function code) | 함수 내부에 존재하는 소스 코드. 함수 내부에 중첩된 함수, 클래스 등 내부 코드는 포함하지 않음. |
| eval 코드(eval code)     | 빌트인 전역 함수인 eval 함수에 인수로 전달되어 실행되는 소스 코드.                            |
| 모듈 코드(module code)   | 모듈 내부에 존재하는 소스 코드. 모듈 내부에 중첩된 코드, 클래스는 포함하지 않음.              |

위 네 가지 소스코드는 실행 컨텍스트를 생성한다.

### 1. 전역 코드

전역 코드는 최상위 스코프인 전역 스코프를 생성한다. 전역 변수와 전역 함수를 전역 객체의 프로퍼티와 메소드로 바인딩하고, 참조하기 위해 전역 객체와 연결한다. 전역 코드가 평가되면 전역 실행 컨텍스트가 생성된다.

### 2. 함수 코드

함수 코드는 지역 스코프를 생성하고 지역 변수, 매개변수, arguments 객체를 관리한다. 생성된 지역 스코프를 전역 스코프에서 시작되는 스코프 체인으로 연결해야 한다. 이를 위해 함수 코드가 평가되면 함수 실행 컨텍스트가 생성된다.

### 3. eval 코드

eval 코드는 strict mode에서 자신만의 독자적인 스코프를 생성한다. 이를 위해 eval 코드가 평가되면 eval 실행 컨텍스트가 생성된다.

### 4. 모듈 코드

모듈 코드는 모듈 별로 독자적인 모듈 스코프를 생성된다. 이를 위해 모듈 코드가 평가되면 모듈 실행 컨텍스트가 생성된다.

## 2. 실행 컨텍스트의 역할

```
// 1. 전역 변수 선언
const x = 1;
const y = 2;

// 2. 함수 정의
function foo(a) {
    // 3. 지역 변수 선언
    const x = 10;
    const y = 20;

    // 4. 메서드 호출
    console.log(a + x + y);
}

// 5. 함수 호출
foo(100);

// 6. 메서드 호출
console.log(x + y);
```

**전역 코드 평가** 과정에서는 `1. 전역 변수 선언문`과 `2. 함수 선언문`만 실행되고, 전역 변수와 전역 함수가 실행 컨텍스트가 관리하는 전역 스코프에 등록된다.
전역 코드 평가가 끝나면 **전역 코드**가 **실행**되기 시작한다. 이때 전역 변수에 값이 할당되고 함수가 호출된다.

### 참고

모던 자바스크립트 Deep Dive
